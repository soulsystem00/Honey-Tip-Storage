# 타이머를 만들어보자  

타이머를 만들때 마다 계속해서 문제가 되었던 것이  
표현 및 자동 반올림의 문제였다.  

그래서 이걸 정리하고자  
이 글을 작성한다.  

10초 타이머를 만든다고 했을 때  
가장 쉽게 생각 할 수 있는 코드는 아래와 같을 것이다.  

```
private float timer = 10f;

public void init(float time)
{
    timer = time;
}

private void Update()
{
    timer -= Time.deltaTime;

    // timer 변수를 이용해 UI에 타임 표시

    if(timer <= 0f)
    {
        // TODO : 타이머 종료시 코드 삽입
        return;
    }
}
```

일단 이렇게 작성을 했을 때  
10초면 10초 20초면 20초 잘 셀 것이고  
분기점에 코드를 삽입하면 해당 코드도 제대로 동작 할 것이다.  

그런데 계속해서 문제가 되었던 것이  
표현의 문제였다.  

내가 timer 변수를 10으로 초기화를 하고나서  
해당 코드를 돌리면  
UI 상으로 10에서 0 까지 일정하게 뜨는 것이 아니라  
아주 잠깐 10이 떴따가 바로 9로 넘어가는 식으로 표현이 되는 것을 볼 수 있었다.  

이러한 이유로는 10에서 Time.deltaTime을 빼면  
9.99999 가 되버리기 때문에  
1초가 흐르지 않았음에도 불구하고  
숫자 상으로는 10에서 9로 넘어가버리기 때문이다.  

그리고 해당 코드는 Time.deltaTime을 먼저 빼버리고 나서  
판단을 진행하기 때문에 10이 안 뜰 것 같지만  
9.9999 같은 경우에는 형변환시 10이 되버리는 경우가 있기 때문에  
10이 뜨는 경우가 있었다.  

그래서 해당 부분에 대한 처리가 필요했다.  
그래서 1을 더하기로 결정했다.  

Init 함수로 초기화를 진행해도  
Update에선 Time.deltaTime을 뺀 이후에 로직을 동작하도록 하면  
무조건 9.9999 부터 값이 시작할 것이기 때문에  
해당 값을 정수부분만 남기고 그 값에 1을 더하는 식으로 코드를 수정했다.  

```
private void Update()
{
    timer -= Time.deltaTime;

    int curTime = (((int)timer) + 1);
}
```

대충 요런식으로 말이다.  

이 경우  
10 ~ 9.0 까지는 10이 되고  
8.9 ~ 8.0 까지는 9가 되고  

0.9 ~ 0.0 까지는 1이 된다.  

문제는 0이 표현되지 않는다는 것이다.  

사실 정확히 따지자면  
0이 표현되지 않는 것이 맞긴 하지만  
사회통념상 카운트를 세면 10부터 시작을 해서 0으로 끝나는 경우가 많다.  

그래서 해당 부분에 대한 처리도 필요할 것이다.  
근데 일단 해당 부분에 처리는 진행해주지 않았다.  

그렇지만 초기값에 1을 더하고 결과 값에 1을 빼는 식으로 진행하면  
표현은 가능할 것이다.  

```
private float timer = 10f;

public void init(float time)
{
    timer = time + 1; // 초기 값에 1을 더해줌
}

private void Update()
{
    timer -= Time.deltaTime;

    int curTime = (((int)timer) + 1);
    curTime--;

    // timer 변수를 이용해 UI에 타임 표시

    if(timer <= 0f)
    {
        // TODO : 타이머 종료시 코드 삽입
        return;
    }
}
```

뭐 이런 식으로 짜게 되면  
10초 카운트를 시작하더라도  
11초 부터 카운트가 들어갈 것이다.  

11.0 ~ 10.0 까지는 11이 되고
9.9 ~ 9.0 까지는 10이 되고  
0.9 ~ 0.0 까지는 1이 될 텐데  

여기서 1을 빼주어서  

11.0 ~ 10.0 까지는 10이 되고
9.9 ~ 9.0 까지는 9이 되고  
0.9 ~ 0.0 까지는 0이 되도록 만들어 줄 것이다.  

이러면 약간 사회 통념에 맞는 카운트가 생길 것이다. 
</br>
</br>
</br>
</br>
</br>

### 잡담
```

```