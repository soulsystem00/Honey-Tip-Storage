# 유니티 WndProc는 초기화 해줘야 한다

SetWindowLongPtr을 이용해서 창 프로시저 변경을 할 수 있는데</br>
보통 빌드 상태에선 창을 껐다가 켜기 때문에</br>
창 프로시저를 초기화 해 줄 필요가 없다.</br>
</br>
하지만 유니티 에디터 상에서 테스트를 한다면</br>
무조건 창 프로시저를 초기화 해주어야 한다.</br>
왜냐하면 에디터는 종료되는 것이 아니고 계속해서 같은 창이 떠있기 때문이다.</br>
</br>
플레이 모드에 들어갈 뿐이지</br>
새롭게 윈도우 창을 켜주는 것이 아니다.</br>
그러므로 이전에 플레이를 하면서 창 프로시저에 변화를 주었다면</br>
변화된 것이 계속해서 남아있게 된다.</br>
</br>
만약에 창 프로시저에 새 주소를 할당하였다면</br>
할당 된 새로운 주소가 계속 남아있다는 뜻이 된다.</br>
</br>
만약에 함수 A의 주소를 할당 하였으면</br>
함수 A가 계속 남아있게 된다.</br>
창을 껐다가 켜면 함수 A의 주소는 날라가겠지만</br>
에디터는 창을 껐다가 키는 방식이 아니고</br>
창은 그대로 남아있되 모드만 바뀌는 형식이기 때문에</br>
내가 할당한 함수 A의 주소가 계속 남아있게 되고</br>
이후에 플레이를 하게 되면</br>
프로시저 단계에서 오류가 발생해 창이 꺼지게 된다.</br>
</br>
그러기 때문에 플레이가 종료될 때 꼭 창 프로시저를 원래대로 돌려주어야 한다.</br>
</br>
만약 그냥 빌드 상태에서만 테스트 할 것이라면 상관이 없다.</br>
왜냐하면 게임을 종료하게 되면 창이 꺼지기 때문이다.</br>
하지만 에디터에서 테스트를 하기 위해선</br>
꼭 창 프로시저를 다시 원래대로 돌려주어야 한다.</br>
</br>
</br>
</br>
</br>
</br>
```
비동기 작성하려고 했는데

또 다른 좋은 주제가 나와서 이걸로 대체했음

근데 이건 진짜 중요한 것 같음

왜냐하면 처음 이 증상을 경험했을 때
이유를 찾을 수 없었기 때문임

아무런 로그도 뜨지 않고 그냥 창이 꺼져버림

창이 그냥 꺼져버리는 경우가 몇가지 있었는데
보통은 메모리 쪽에 오류가 나거나 엔진 쪽에서 오류가 나는 경우가 많았음
이런 경우 내가 할 수 있는 것이 없음

근데 이상하게 wndproc 초기화를 하거나 하면 일어나서
열심히 디버깅을 해보니 알아낼 수 있던 오류였음

근데 이게 빌드 상태에선 일어날 수 없는 구조라
더더욱 찾기 힘들었음

아무튼 창 프로시저를 사용하기 위해선
꼭 알아두어야 할 중요한 정보라는 것은 분명함
```